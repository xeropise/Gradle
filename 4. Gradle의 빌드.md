### 그레이들의 빌드

- 빌드란 무엇인가?

  - 소프트웨어의 빌드는 소스 코드 파일을 컴퓨터에서 실행할 수 있는 독립 소프트웨어 가공물로 변환하는 과정 또는 그 결과

    

  - 빌드 대상이 되는 소스 코드의 언어 종류에 따라 빌드 프로세스(순서)나 생성되는 결과물이 다르다. 같은 빌드를 한다고 해도 C언어와 자바의 코드가 다르며 내용도 다르다.

    - C언어의 유닉스 계열 라이브러리

      - 컴파일 후 생성된 객체 파일을 링크해서 .a 파일이나 .so 파일로 변환

        

    - 자바 어플리케이션

      - 컴파일 후 .class 파일과 함께 META-INF 디렉터리와 MANIFEST.MF 을 추가해서 JAR 파일로 압축

        

- 물론, 언어의 빌드에만 국한되는 것이 아니라, 빌드 대상에 어떤 액션을 취하는 것을 말함.

  - 예를 들자면 디렉터리의 파일을 별도의 디렉터리에 복사한다던지 지정한 애플리케이션을 실행하는 작업도 포함



- 그레이들 빌드의 입력 정보

  - [초기화 스크립트](https://docs.gradle.org/current/userguide/init_scripts.html#sec:using_an_init_script)

    - 빌드 실행 시, 가장 먼저 실행 되는 스크립트로 보통 기본 파일명은 init.gradle 이였으나, 초기화 스크립트 지정 방법이 다양하다. 링크 참조

      

  - [설정 스크립트](https://docs.gradle.org/current/userguide/build_lifecycle.html#sec:settings_file)

    - 빌드 대상 프로젝트를 설정하는 스크립트로 기본 파일명은 settings.gradle 로 빌드에 포함할 프로젝트를 정의하는데 사용한다.

      

    - 멀티 프로젝트에서는 반드시 필요한 스크립트 파일로, 그레이들의 규칙에 따라 파일과 디렉터리를 배치해야 한다.

    

  - 빌드 스크립트

    - 빌드 입력 정보 중에서 가장 중요한 '빌드 정의'를 기술하는 스크립트로, 기본 파일명은 build.gradle 이다 프로젝트의 의존관계나 태스크 정의를 할 때 사용하며, 일반적인 빌드에서는 이 파일만 있어도 된다.

    

  - [속성 파일](https://docs.gradle.org/current/userguide/build_environment.html)

    - 그레이들이 표준으로 참조하는 속성 파일로, 파일명은 gradle.properties 이다. 환경에 따라 값이 달라지는 파라미터를 빌드 스크립트 밖에 기술하고 싶을 때 사용된다.

      

    - 빌드 실행 시 자동으로, 이 파일을 읽으므로 빌드 스크립트에 따로 기술하지 않고도 편리하게 사용 가능하다.

      

    - 빌드를 실행하기 위한 설정 값들을 여기에 설정할 수 있다.

      - 예를 들자면 JVM 메모리 설정, JAVA HOME 로케이션 등등 설정 가능, 링크 참조

    

  - [환경 변수/명령줄 인수](https://docs.gradle.org/current/userguide/build_environment.html#sec:gradle_system_properties)

    - 그레이들이 설치된 장비의 환경 변수와 빌드 실행 시 명령줄에서 전달하는 인수를 의미

      

    - 그레이들이 실행하는 프로세스에 고유한 환경 값을 전달하고 싶거나 실행에 관련된 설정을 할 때 필요

    

  - [buildSrc 프로젝트](https://docs.gradle.org/current/userguide/organizing_gradle_projects.html#sec:build_sources)

    - 빌드 시 참조하는 클래스 파일이나 플러그인 코드를 저장하는 프로젝트 디렉터리

      

    - 여러 개의 빌드 스크립트가 참조하는 클래스 파일이나 자체 플러그인을 저장할 때 사용

      

    - 표준 빌드에서는 사용할 일이 거의 없지만, 복잡한 처리를 해야 하는 빌드에서 사용하면 빌드 스크립트와 처리를 분할할 수 있다.

    

- 그레이들의 [빌드 라이프 사이클](https://docs.gradle.org/current/userguide/build_lifecycle.html#sec:settings_file)

  - 명령어 해석 ~ 그레이들 실행

    - gradle 명령의 명령줄 인수를 해석해서, 명령줄 옵션이 제대로 지정되었는지 확인

      

    - 명령줄 옵션으로 홈 디렉터리의 경로와 프로젝트 디레터리를 해석하고 속성 파일을 읽음

      

    - 마지막으로 명령줄 옵션을 기준으로 적절한 실행 모드 (3가지 실행 모드 : CLI, 데몬, GUI) 를 판정하고, 실행 환경에 맞는 클래스를 선별해서 인스턴스로 만듦

      

  - 스크립트 파일 초기화

    - 그레이들을 실행하면 바로 빌드가 시작된다.

      - 초기화 단계로 스크립트 파일을 읽거나 그레이들의 실체인 도메인 객체를 생성하는 단계

        

      - 빌드 대상이 싱글 프로젝트인지 멀티 프로젝트인지 명확하게 한 다음, 프로젝트를 나타내는 도메인 객체를 생성하는 것이다.

        

      - 존재하는 스크립트 파일을 기준으로, 현재 프로젝트르  기준으로 하여 Project 객체를 생성한다.

        

  - 프로젝트 설정

    - 설정 단계라고 하며, 프로젝트가 참조하는 의존 라이브러리 해석이나 태스크 생성 같은 빌드 실행을 위한 준비 작업을 한다.

      

    - 이 단계에서 가장 중요한 것은 정의된 태스크를 조사해서 태스크 간 의존관계를 그래프로 만든 태스트 그래프를 작성하는 것이다.

      

  - 태스크 실행

    - 마지막으로 태스크를 실행하는 단계로, 설정 단계에서 작성한 태스크 그래프에서 실행 대상 태스크를 추출하여 실행 한다.